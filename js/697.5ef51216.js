"use strict";(self["webpackChunkorigin"]=self["webpackChunkorigin"]||[]).push([[697],{2697:function(e,t,o){o.r(t),o.d(t,{default:function(){return U}});o(4114);var l=o(6768),a=o(5130),r=o(4232),s=o(144),n=o(4373);const i=e=>((0,l.Qi)("data-v-0491b68b"),e=e(),(0,l.jt)(),e),u={class:"book-cover"},c=i((()=>(0,l.Lk)("div",{class:"cover-pattern"},null,-1))),v={class:"cover-title"},d={class:"book-info"},g={class:"book-category"},h={class:"book-name"},p={class:"book-author"},k={class:"book-desc"};var y={__name:"BookCard",props:{title:{type:String,required:!0},author:{type:String,required:!0},description:{type:String,required:!0},coverColor:{type:String,required:!0},category:{type:String,required:!0}},setup(e){return(t,o)=>((0,l.uX)(),(0,l.CE)("div",{class:"book-card",style:(0,r.Tr)({"--cover-color":e.coverColor})},[(0,l.Lk)("div",u,[c,(0,l.Lk)("div",v,(0,r.v_)(e.title),1)]),(0,l.Lk)("div",d,[(0,l.Lk)("div",g,(0,r.v_)(e.category),1),(0,l.Lk)("h3",h,(0,r.v_)(e.title),1),(0,l.Lk)("p",p,"作者："+(0,r.v_)(e.author),1),(0,l.Lk)("p",k,(0,r.v_)(e.description),1)])],4))}},w=o(1241);const f=(0,w.A)(y,[["__scopeId","data-v-0491b68b"]]);var m=f;function C(){const e=(e,t="info",o=3e3)=>{const l=()=>{window.$toast&&window.$toast[t]?window.$toast[t](e,o):setTimeout((()=>{window.$toast&&window.$toast[t]?window.$toast[t](e,o):console.warn("Toast component not initialized, message:",e)}),100)};l()};return{success:(t,o)=>e(t,"success",o),error:(t,o)=>e(t,"error",o),warning:(t,o)=>e(t,"warning",o),info:(t,o)=>e(t,"info",o)}}const b=e=>((0,l.Qi)("data-v-2870cb15"),e=e(),(0,l.jt)(),e),L={class:"book-header"},_=b((()=>(0,l.Lk)("h1",{class:"book-title"},"图书列表",-1))),S=b((()=>(0,l.Lk)("p",{class:"book-subtitle"},"探索知识的海洋，发现阅读的乐趣",-1))),$={class:"search-container"},E={key:0,class:"search-results-info"},T={key:0,class:"no-results"},X=b((()=>(0,l.Lk)("p",{class:"no-results-text"},"暂无图书数据",-1))),R=b((()=>(0,l.Lk)("p",{class:"no-results-hint"},"请稍后重试",-1))),V=[X,R],A={key:1,class:"no-results"},K=b((()=>(0,l.Lk)("p",{class:"no-results-text"},"未找到相关图书",-1))),Q=b((()=>(0,l.Lk)("p",{class:"no-results-hint"},"试试搜索其他关键词",-1))),x=[K,Q],q={key:2,class:"book-container"},P={key:3,class:"loading-indicator"},B=b((()=>(0,l.Lk)("div",{class:"loading-spinner"},null,-1))),F=b((()=>(0,l.Lk)("p",{class:"loading-text"},"加载中...",-1))),I=[B,F],j={key:4,class:"no-more"},H=b((()=>(0,l.Lk)("p",null,"已加载全部图书",-1))),W=[H],z={key:5,class:"no-more"},D=b((()=>(0,l.Lk)("p",null,"已显示全部搜索结果",-1))),J=[D];var M={__name:"BookListView",setup(e){const t=C(),o=(0,s.KR)([]),i=(0,s.KR)([]),u=(0,s.KR)(1),c=(0,s.KR)(6),v=(0,s.KR)(!1),d=(0,s.KR)(!0),g=(0,s.KR)(null),h=(0,s.KR)("");let p=null;const k=(0,l.EW)((()=>{if(!Array.isArray(o.value)||0===o.value.length)return[];if(!h.value||!h.value.trim())return o.value;const e=h.value.toLowerCase().trim();return o.value.filter((t=>{if(!t)return!1;const o=(t.title||"").toLowerCase(),l=(t.author||"").toLowerCase(),a=(t.description||"").toLowerCase(),r=(t.category||"").toLowerCase();return o.includes(e)||l.includes(e)||a.includes(e)||r.includes(e)}))}));function y(e){if(!e||!e.trim())return console.warn("CSV text is empty"),[];const t=e.trim().split("\n").filter((e=>e.trim()));if(t.length<2)return console.warn("CSV file has no data rows"),[];const o=t[0].split(",").map((e=>e.trim())),l=[];for(let a=1;a<t.length;a++){const e=t[a].trim();if(!e)continue;const r=[];let s="",n=!1;for(let t=0;t<e.length;t++){const o=e[t];'"'===o?n=!n:","!==o||n?s+=o:(r.push(s.trim()),s="")}if(r.push(s.trim()),r.length===o.length){const e={};o.forEach(((t,o)=>{e[t]=r[o]||""})),e.title&&e.author&&l.push(e)}else console.warn(`Row ${a} has ${r.length} values, expected ${o.length}:`,r)}return console.log(`Parsed ${l.length} books from CSV`),l}function w(){if(v.value||!d.value)return;const e=k.value;Array.isArray(e)&&0!==e.length?(v.value=!0,setTimeout((()=>{const t=(u.value-1)*c.value,o=t+c.value,l=e.slice(t,o);l.length>0?(i.value.push(...l),u.value++,o>=e.length&&(d.value=!1)):d.value=!1,v.value=!1}),500)):d.value=!1}function f(){i.value=[],u.value=1;const e=k.value;d.value=e.length>0,e.length>0&&w()}function b(e){p&&clearTimeout(p),p=setTimeout((()=>{const t=e.target,o=t.scrollTop,l=t.scrollHeight,a=t.clientHeight;l-o-a<200&&w()}),100)}return(0,l.wB)(h,(()=>{Array.isArray(o.value)&&f()}),{immediate:!1}),(0,l.sV)((async()=>{try{v.value=!0;const e=await n.A.get("/books.csv");console.log("CSV Response:",e.data.substring(0,200));const l=y(e.data);console.log("Parsed CSV Data:",l),o.value=l,await new Promise((e=>setTimeout(e,200))),console.log("Books after assignment:",o.value.length),o.value.length>0?(i.value=[],u.value=1,d.value=!0,await new Promise((e=>{setTimeout((()=>{const l=k.value;if(console.log("Filtered books:",l.length),l.length>0){const e=0,a=Math.min(c.value,l.length),r=l.slice(e,a);i.value=[...r],u.value=2,a>=l.length&&(d.value=!1),v.value=!1,t.success(`成功加载 ${o.value.length} 本图书`)}else console.warn("Filtered books is empty"),v.value=!1;e()}),100)}))):(console.warn("No books loaded from CSV"),t.warning("未找到图书数据"),v.value=!1)}catch(e){console.error("Failed to load books from CSV:",e),t.error("加载图书数据失败，已使用默认数据"),o.value=[{title:"三体",author:"刘慈欣",description:"刘慈欣所著的科幻小说，讲述了地球文明与三体文明之间的交流与对抗。",coverColor:"#2d7a6b",category:"科幻"},{title:"西游八十一案：大唐梵天记",author:"陈渐",description:"记录时光的痕迹，感受岁月的沉淀。每一页都是生活的缩影，每一个故事都值得珍藏。",coverColor:"#8b6f47",category:"文学"},{title:"智慧之光",author:"作者名",description:"知识的灯塔，照亮前行的路。汇聚古今中外的智慧结晶，启迪心灵，开阔视野。",coverColor:"#1e5a4a",category:"哲学"},{title:"艺术人生",author:"作者名",description:"艺术源于生活，高于生活。感受艺术的魅力，体验创作的快乐，发现美的真谛。",coverColor:"#5a4a3a",category:"艺术"},{title:"科学探索",author:"作者名",description:"科学的奥秘等待我们去发现。从微观到宏观，从过去到未来，探索未知的世界。",coverColor:"#2d7a6b",category:"科学"},{title:"历史长河",author:"作者名",description:"回顾历史，展望未来。了解过去的故事，理解现在的发展，预见未来的趋势。",coverColor:"#8b6f47",category:"历史"},{title:"心灵之旅",author:"作者名",description:"内心的探索，精神的成长。在阅读中寻找答案，在思考中获得智慧，在感悟中提升自我。",coverColor:"#1e5a4a",category:"心理"},{title:"创意无限",author:"作者名",description:"激发创意，释放潜能。从不同的角度思考问题，用创新的方式解决问题，创造无限可能。",coverColor:"#5a4a3a",category:"设计"}],await new Promise((e=>setTimeout(e,100))),o.value.length>0&&(i.value=[],u.value=1,d.value=!0,w()),v.value=!1}})),(0,l.hi)((()=>{p&&clearTimeout(p)})),(e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:"book-list-view",onScroll:b,ref_key:"scrollContainer",ref:g},[(0,l.Lk)("div",L,[_,S,(0,l.Lk)("div",$,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),type:"text",class:"search-input",placeholder:"搜索书名、作者、分类...",onInput:f},null,544),[[a.Jo,h.value]]),h.value?((0,l.uX)(),(0,l.CE)("div",E," 找到 "+(0,r.v_)(k.value.length)+" 本相关图书 ",1)):(0,l.Q3)("",!0)])]),v.value||0!==o.value.length?h.value&&0===k.value.length&&!v.value&&o.value.length>0?((0,l.uX)(),(0,l.CE)("div",A,x)):i.value.length>0?((0,l.uX)(),(0,l.CE)("div",q,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.value,((e,t)=>((0,l.uX)(),(0,l.Wv)(m,{key:`${e.title||"book"}-${t}`,title:e.title,author:e.author,description:e.description,"cover-color":e.coverColor,category:e.category},null,8,["title","author","description","cover-color","category"])))),128))])):(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",T,V)),v.value?((0,l.uX)(),(0,l.CE)("div",P,I)):(0,l.Q3)("",!0),!1===d.value&&i.value.length>0&&!h.value?((0,l.uX)(),(0,l.CE)("div",j,W)):(0,l.Q3)("",!0),!1===d.value&&i.value.length>0&&h.value?((0,l.uX)(),(0,l.CE)("div",z,J)):(0,l.Q3)("",!0)],544))}};const N=(0,w.A)(M,[["__scopeId","data-v-2870cb15"]]);var U=N}}]);
//# sourceMappingURL=697.5ef51216.js.map